/*
 *  game-of-life.js - v0.2.0
 *  HTML5 canvas game of life.
 *  https://github.com/eschmar/game-of-life
 *
 *  @author:   Marcel Eschmann, @eschmar
 *  @license:  MIT License
 */
!function(i,n){"use strict";var e={cellSize:8,colors:["#490D7F","#B666FF","#921AFF","#5B337F","#7515CC"],colorEmpty:"#fafafa",transparent:!0,speed:100,onClick:!1};function t(t,i){this.element=n.querySelector(t),"CANVAS"===this.element.nodeName&&(this.settings=this.extend({},e,i),this.init())}t.prototype.init=function(){this.ctx=this.element.getContext("2d"),this.xLength=Math.floor(this.element.width/this.settings.cellSize),this.yLength=Math.floor(this.element.height/this.settings.cellSize),this.population=[];for(var t=0;t<this.xLength;t++)this.population[t]=[];this.settings.onClick&&this.initOnClick()},t.prototype.initOnClick=function(){function t(t){var i,e,s=o.element.getBoundingClientRect();i=t.pageX-s.left+n.body.scrollLeft,e=t.pageY-s.top+n.body.scrollTop,o.settings.onClick(o,Math.floor(i/o.settings.cellSize),Math.floor(e/o.settings.cellSize)),t.stopPropagation()}var o=this;i.addEventListener("click",t),i.addEventListener("touchstart",t)},t.prototype.populate=function(t,i){var e=Math.floor(10*Math.random()%this.settings.colors.length);this.ctx.fillStyle=this.settings.colors[e],this.ctx.fillRect(t*this.settings.cellSize+1,i*this.settings.cellSize+1,this.settings.cellSize-1,this.settings.cellSize-1)},t.prototype.kill=function(t,i){this.settings.transparent?this.ctx.clearRect(t*this.settings.cellSize+1,i*this.settings.cellSize+1,this.settings.cellSize-1,this.settings.cellSize-1):(this.ctx.fillStyle=this.settings.colorEmpty,this.ctx.fillRect(t*this.settings.cellSize+1,i*this.settings.cellSize+1,this.settings.cellSize-1,this.settings.cellSize-1))},t.prototype.live=function(t,i){var e=this.neighbours(t,i);this.population[t][i]&&(e<2||3<e)?this.future[t][i]=!1:3===e&&(this.future[t][i]=!0)},t.prototype.neighbours=function(t,i){for(var e,s,o=0,n=-1;n<2;n++)for(var h=-1;h<2;h++)e=(t+n+this.xLength)%this.xLength,s=(i+h+this.yLength)%this.yLength,this.population[e][s]&&o++;return this.population[t][i]&&o--,o},t.prototype.randomize=function(){for(var t=0;t<this.xLength;t++)for(var i=0;i<this.yLength;i++)Math.floor(10*Math.random()%2)&&(this.populate(t,i,0),this.population[t][i]=!0)},t.prototype.killAll=function(){var t=this.alive;this.alive&&this.toggle();for(var i=0;i<this.xLength;i++)for(var e=0;e<this.yLength;e++)this.population[i][e]=!1,this.kill(i,e);this.future=this.extend(!0,[],this.population),t&&this.toggle()},t.prototype.addLifeForm=function(t,i,e){var s,o,n;for(n=0;n<e.length;n++)s=(t+e[n][0]+this.xLength)%this.xLength,o=(i+e[n][1]+this.yLength)%this.yLength,this.populate(s,o),this.population[s][o]=!0},t.prototype.addGlider=function(t,i){this.addLifeForm(t,i,[[1,0],[2,1],[0,2],[1,2],[2,2]])},t.prototype.addWeekender=function(t,i){this.addLifeForm(t,i,[[2,0],[15,0],[2,1],[15,1],[1,2],[3,2],[14,2],[16,2],[2,3],[15,3],[2,4],[15,4],[3,5],[7,5],[8,5],[9,5],[10,5],[14,5],[7,6],[8,6],[9,6],[10,6],[3,7],[4,7],[5,7],[6,7],[11,7],[12,7],[13,7],[14,7],[5,9],[12,9],[6,10],[7,10],[10,10],[11,10]])},t.prototype.addCustomLifeForm1=function(t,i){this.addLifeForm(t,i,[[2,0],[15,0],[2,1],[15,1],[1,2],[3,2],[14,2],[16,2],[2,3],[15,3],[2,4],[15,4],[3,5],[7,5],[8,5],[9,5],[10,5],[14,5],[7,6],[8,6],[9,6],[10,6],[3,7],[4,7],[5,7],[6,7],[11,7],[12,7],[13,7],[14,7],[5,9],[12,9],[6,10],[7,10],[10,9],[11,9]])},t.prototype.addSiesta=function(t,i){this.addLifeForm(t,i,[[13,0],[14,0],[5,1],[6,1],[12,1],[14,1],[5,2],[7,2],[12,2],[7,3],[11,3],[12,3],[14,3],[5,4],[7,4],[8,4],[14,4],[15,4],[16,4],[3,5],[4,5],[5,5],[11,5],[13,5],[17,5],[2,6],[6,6],[8,6],[14,6],[15,6],[16,6],[3,7],[4,7],[5,7],[11,7],[12,7],[14,7],[5,8],[7,8],[8,8],[12,8],[7,9],[12,9],[14,9],[5,10],[7,10],[13,10],[14,10],[5,11],[6,11]])},t.prototype.advance=function(){this.future=this.deepExtend([],this.population);for(var t=0;t<this.xLength;t++)for(var i=0;i<this.yLength;i++)this.live(t,i);for(t=0;t<this.xLength;t++)for(i=0;i<this.yLength;i++)this.population[t][i]!==this.future[t][i]&&(this.future[t][i]?this.populate(t,i):this.kill(t,i));this.population=this.future},t.prototype.toggle=function(){if(this.alive)clearInterval(this.timer),this.alive=!1;else{var t=this;this.timer=setInterval(function(){t.advance()},this.settings.speed),this.alive=!0}},t.prototype.extend=function(t){t=t||{};for(var i=1;i<arguments.length;i++)if(arguments[i])for(var e in arguments[i])arguments[i].hasOwnProperty(e)&&(t[e]=arguments[i][e]);return t},t.prototype.deepExtend=function(t){t=t||{};for(var i=1;i<arguments.length;i++){var e=arguments[i];if(e)for(var s in e)e.hasOwnProperty(s)&&("object"==typeof e[s]?t[s]=this.deepExtend(t[s],e[s]):t[s]=e[s])}return t},i.GameOfLife=t}(window,document);